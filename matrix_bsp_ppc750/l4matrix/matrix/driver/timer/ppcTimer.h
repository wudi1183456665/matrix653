/*********************************************************************************************************
**
**                                    中国软件开源组织
**
**                                   嵌入式实时操作系统
**
**                                SylixOS(TM)  LW : long wing
**
**                               Copyright All Rights Reserved
**
**--------------文件信息--------------------------------------------------------------------------------
**
** 文   件   名: ppcTimer.h
**
** 创   建   人:
**
** 文件创建日期: 2018 年 8 月 7 日
**
** 描        述: 定时器支持.
*********************************************************************************************************/

#ifndef __I8254_H
#define __I8254_H

#include <Matrix.h>

/*********************************************************************************************************
  i8254 control
*********************************************************************************************************/

typedef struct ppc_timer PPC_TIME;

struct ppc_timer {
    /*
     *  user MUST set following members before calling this module api.
     */
    addr_t  iobase;                                                     /* 8254 I/O base address        */
                                                                        /* eg. IO-BASE + 0x40           */
    addr_t  iobuzzer;                                                   /* speaker 8255 port            */
                                                                        /* eg. IO-BASE + 0x61           */
    unsigned int qcofreq;                                               /* default : 1193182            */
};

/*********************************************************************************************************
   tick timer functions
*********************************************************************************************************/

UINT16  ppcTimerInit(PPC_TIME *pctl, UINT32  uiHz);
UINT16  ppcTimerInitAsTick(PPC_TIME *pctl);
UINT16  ppcTimerInitAsHtimer(PPC_TIME *pctl);
UINT16  ppcTimerGetCnt(PPC_TIME *pctl);

/*********************************************************************************************************
   buzzer functions
*********************************************************************************************************/

VOID    ppcTimerBuzzerOn(PPC_TIME *pctl, UINT32  uiHz);
VOID    ppcTimerBuzzerOff(PPC_TIME *pctl);

#endif                                                                  /*  __I8259A_H                  */
/*********************************************************************************************************
  END
*********************************************************************************************************/
