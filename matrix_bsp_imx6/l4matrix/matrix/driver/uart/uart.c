/*********************************************************************************************************
**
**                                    中国软件开源组织
**
**                                嵌入式 L4 微内核操作系统
**
**                                SylixOS(TM)  MX : matrix
**
**                               Copyright All Rights Reserved
**
**--------------文件信息--------------------------------------------------------------------------------
**
** 文   件   名: uart.c
**
** 创   建   人: Wang.Dongfang (王东方)
**
** 文件创建日期: 2018 年 01 月 19 日
**
** 描        述: UART 驱动 (测试版本使用).
*********************************************************************************************************/
#include <Matrix.h>
/*********************************************************************************************************
    IMX6Q UART1 寄存器地址
*********************************************************************************************************/
#define     UART1_BASE_ADDRESS              0x02020000                  /*  UART1 base address          */
#define     UART1_VALUE                     (*(volatile UINT32 *)(UART1_BASE_ADDRESS + 0x40))
#define     UART1_STATUS                    (*(volatile UINT32 *)(UART1_BASE_ADDRESS + 0xB4))
/*********************************************************************************************************
** 函数名称: uartPutChar
** 功能描述: 将字符输出到 imx6q 的 uart1
** 输　入  : ucChar    要输出的字符
** 输　出  : 输出字符个数
** 全局变量: 
** 调用模块: 
*********************************************************************************************************/
INT  uartPutChar (UCHAR  ucChar)
{
    if (ucChar == '\n') {
        while (UART1_STATUS & (1 << 4)) {
        }
        UART1_VALUE = '\r';
    }

    while (UART1_STATUS & (1 << 4)) {
    }
    UART1_VALUE = ucChar;

    return  (1);
}
/*********************************************************************************************************
** 函数名称: uartPutStr
** 功能描述: 将字符串输出到 imx6q 的 uart1
** 输　入  : pucStr    要输出的字符串   
** 输　出  : 输出字符个数
** 全局变量: 
** 调用模块: 
*********************************************************************************************************/
INT  uartPutStr (PUCHAR  pucStr)
{
    INT  i = 0;

    while (*pucStr) {
        uartPutChar(*pucStr++);
        i++;
    }

    return  (i);
}
/*********************************************************************************************************
 ** 函数名称: uartGetChar
 ** 功能描述: 从imx6q 的 uart1取出字符
 ** 输　入  : 无
 ** 输　出  : 字符
 ** 全局变量:
 ** 调用模块:
 *********************************************************************************************************/
 UCHAR  uartGetStr (void)
 {
     UCHAR ch;

     while (UART1_STATUS & (1 << 4))
     {}
    	 ch=UART1_VALUE;
     return ch;
 }
/*********************************************************************************************************
  END
*********************************************************************************************************/

